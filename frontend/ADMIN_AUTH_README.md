# Авторизация Админ-панели

## Обзор

Добавлена система авторизации для админ-панели Casino Roulette. Теперь доступ к административным функциям защищен
паролем.

## Структура

### Страницы

1. **`/admin`** - Основная админ-панель с авторизацией (полная информация)
2. **`/admin-dashboard`** - Упрощенная админ-панель без авторизации (ограниченная информация)

### Компоненты

- **`AdminAuthForm`** - Форма входа в систему
    - Расположение: `src/components/casino/components/adminAuth/AdminAuthForm.tsx`
    - Функции: ввод пароля, показ/скрытие пароля, обработка ошибок

### Хуки

- **`useAdminAuth`** - Управление состоянием авторизации
    - Расположение: `src/components/casino/hooks/useAdminAuth.ts`
    - Функции: проверка пароля, сохранение сессии, автоматический выход

## Конфигурация

### Пароль по умолчанию

```typescript
const ADMIN_PASSWORD = 'admin123';
```

> ⚠️ **Важно**: В продакшене пароль должен храниться в переменных окружения!

### Настройки сессии

- **Время жизни сессии**: 24 часа
- **Ключ в localStorage**: `casino_admin_auth`
- **Автоматическое продление**: Нет

## Использование

### Вход в систему

1. Перейдите на `/admin`
2. Введите пароль: `admin123`
3. Нажмите "Войти"

### Выход из системы

- Нажмите кнопку "Выйти" в правом верхнем углу
- Или подождите 24 часа для автоматического выхода

### Функциональность

После авторизации доступны все функции админ-панели:

- Просмотр активных сессий
- Мониторинг подключений
- Просмотр статистики
- Анализ истории игр

## Безопасность

### Реализованные меры

1. **Хеширование пароля**: Пароль сравнивается напрямую (для демо)
2. **Время жизни сессии**: Автоматический выход через 24 часа
3. **Локальное хранение**: Токен авторизации в localStorage
4. **Защита от перехвата**: HTTPS рекомендуется для продакшена

### Рекомендации для продакшена

1. **Переменные окружения**:
   ```bash
   ADMIN_PASSWORD=your_secure_password_here
   ```

2. **JWT токены**: Замените localStorage на httpOnly cookies

3. **Хеширование**: Используйте bcrypt или аналогичные библиотеки

4. **2FA**: Добавьте двухфакторную аутентификацию

5. **Rate limiting**: Ограничьте количество попыток входа

## Разработка

### Добавление новых административных страниц

1. Создайте компонент страницы
2. Оберните в `useAdminAuth` хук
3. Добавьте условный рендеринг:

```typescript
const { isAuthenticated, isLoading, authenticate, logout } = useAdminAuth();

if (!isAuthenticated) {
  return <AdminAuthForm onAuth={authenticate} />;
}

return <YourAdminContent />;
```

### Тестирование

- **Упрощенная версия**: Используйте `/admin-dashboard` (без IP, браузера, паролей)
- **Полная версия с авторизацией**: Используйте `/admin` с паролем `admin123`

## Структура файлов

```
frontend/src/
├── app/
│   ├── admin/                    # Админ-панель с авторизацией (полная)
│   │   └── page.tsx
│   └── admin-dashboard/          # Упрощенная версия без авторизации
│       └── page.tsx
├── components/casino/
│   ├── components/
│   │   ├── adminAuth/
│   │   │   └── AdminAuthForm.tsx # Форма авторизации
│   │   └── index.ts              # Экспорты компонентов
│   └── hooks/
│       ├── useAdminAuth.ts       # Хук авторизации
│       └── index.ts              # Экспорты хуков
```

## Различия между версиями

### Полная версия (`/admin`) - требует авторизацию:

- ✅ Все статистические карточки
- ✅ IP адреса подключений
- ✅ Данные браузеров (User Agent)
- ✅ Пароли сессий
- ✅ Детальная информация о подключениях

### Упрощенная версия (`/admin-dashboard`) - открытый доступ:

- ✅ Основные статистики (активные сессии и подключения)
- ❌ IP адреса (показывается "-")
- ❌ Данные браузеров (показывается "-")
- ❌ Пароли сессий (скрыты)
- ❌ Детали подключений (раскрывающийся список убран)
- ❌ Детальная статистика (средняя длина истории, общее количество сессий)

## API Endpoints

Админ-панель использует следующие API endpoints:

- `GET /api/admin/sessions` - Получение списка сессий
- `GET /api/admin/stats` - Получение статистики
- `GET /api/admin/sessions/{key}/history` - История конкретной сессии

> Эти endpoints должны быть защищены на уровне backend'а! 